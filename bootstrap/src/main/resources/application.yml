application:
  version: @project.version@

# /info actuator endpoint:
info:
  app:
    name: @project.parent.artifactId@
    version: @project.version@

spring:
  application.name: HESPERIDES
  boot.admin.client.enabled: false
  profiles.active: ${SPRING_PROFILES_ACTIVE:default}

server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /rest
  compression:
    enabled: true
    mime-types: application/json

hesperides:
  security:
    auth-whitelist: ${AUTH_WHITELIST:/versions|/manage/**|/swagger-resources/|/swagger-ui.html|/v2/api-docs|/webjars/**}
  cache:
    get-all-applications-detail:
      duration-in-hours: ${GET_ALL_APPLICATIONS_DETAIL_CACHE_DURATION_IN_HOURS:1}

ldap:
  url: ${LDAP_URL}
  domain: ${LDAP_DOMAIN}
  userSearchBase: ${LDAP_USER_SEARCH_BASE}
  roleSearchBase: ${LDAP_ROLE_SEARCH_BASE}
  usernameAttribute: ${LDAP_USERNAME_ATTRIBUTE}
  connectTimeout: ${LDAP_CONNECT_TIMEOUT:5000}
  readTimeout: ${LDAP_READ_TIMEOUT:5000}
  prodGroupName: ${LDAP_PROD_GROUP_NAME}
  techGroupName: ${LDAP_TECH_GROUP_NAME}

logging:
  file: /var/log/hesperides.log
  level:
    root: INFO
    org:
      axonframework.queryhandling.responsetypes.MultipleInstancesResponseType: WARN
      hesperides:
        commons:
          VersionIdLogger: ${VERSION_ID_LOG_LEVEL:INFO}
        core:
          application.files.FileValuationContext: ${FILE_VALUATION_LOG_LEVEL:INFO}
          domain.templatecontainers.entities.AbstractProperty: ${PROPERTY_AGGREGATION_LOG_LEVEL:INFO}
          domain.modules.commands.ModuleAggregate: ${AGGREGATES_LOG_LEVEL:INFO}
          domain.platforms.commands.PlatformAggregate: ${AGGREGATES_LOG_LEVEL:INFO
      springframework:
        data.mongodb.core.MongoTemplate: ${MONGO_QUERIES_LOG_LEVEL:INFO}
        # On ne logue pas les nombreux "Ignoring PartialResultException"
        # dus aux champs referrals ignorÃ©s, cf. https://docs.spring.io/spring-ldap/docs/2.3.2.RELEASE/reference/#ldaptemplate-configuration
        security.ldap.SpringSecurityLdapTemplate: WARN

# Access it: http://localhost:8080/rest/manage
# Includes but does not limit to:
# - /manage/beans
# - /manage/caches
# - /manage/health
# - /manage/configprops
# - /manage/env
# - /manage/info
# - /manage/loggers
# - /manage/heapdump
# - /manage/threaddump
# - /manage/metrics -> /manage/metrics/cache.size & more
# - /manage/scheduledtasks
# - /manage/httptrace
management:
  health:
    ldap:
      enabled: false
  endpoint:
    health:
      show-details: always
    prometheus:
      enabled: ${ENABLE_PROMETHEUS_METRICS:true}
  endpoints:
    web:
      base-path: /manage
      exposure:
        include: '*'

swagger:
  host: ${SWAGGER_HOST:}